{% extends 'filiale/base.html' %}

{% block title %}{{ prestito.nome }}{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<section class="py-3 bg-light">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                <li class="breadcrumb-item"><a href="{% url 'servizi' %}">Servizi</a></li>
                <li class="breadcrumb-item active">{{ prestito.nome }}</li>
            </ol>
        </nav>
    </div>
</section>

<!-- Dettaglio Prestito -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="mb-4">
                    <span class="badge bg-danger mb-2">{{ prestito.get_categoria_display }}</span>
                    <h1 class="display-5">{{ prestito.nome }}</h1>
                    <p class="lead text-muted">{{ prestito.descrizione_breve }}</p>
                </div>

                <!-- Caratteristiche Principali -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-4">Caratteristiche Principali</h4>
                        <div class="row text-center">
                            <div class="col-md-3 mb-3">
                                <i class="fas fa-percentage fa-2x text-danger mb-2"></i>
                                <p class="mb-1"><strong>TAN da</strong></p>
                                <h4 class="text-danger">{{ prestito.tasso_interesse_da }}%</h4>
                            </div>
                            <div class="col-md-3 mb-3">
                                <i class="fas fa-euro-sign fa-2x text-danger mb-2"></i>
                                <p class="mb-1"><strong>Importo</strong></p>
                                <h6>€{{ prestito.importo_minimo|floatformat:0 }}<br>€{{ prestito.importo_massimo|floatformat:0 }}</h6>
                            </div>
                            <div class="col-md-3 mb-3">
                                <i class="fas fa-calendar-alt fa-2x text-danger mb-2"></i>
                                <p class="mb-1"><strong>Durata</strong></p>
                                <h6>{{ prestito.durata_mesi_min }}-{{ prestito.durata_mesi_max }}<br>mesi</h6>
                            </div>
                            <div class="col-md-3 mb-3">
                                <i class="fas fa-clock fa-2x text-danger mb-2"></i>
                                <p class="mb-1"><strong>Risposta</strong></p>
                                <h6>24-48<br>ore</h6>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Descrizione Completa -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-3">Descrizione</h4>
                        <div style="white-space: pre-line;">{{ prestito.descrizione_completa }}</div>
                    </div>
                </div>

                <!-- Vantaggi -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-3"><i class="fas fa-check-circle text-success"></i> Vantaggi</h4>
                        <ul class="list-unstyled">
                            {% for vantaggio in prestito.vantaggi.splitlines %}
                            {% if vantaggio.strip %}
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>{{ vantaggio }}
                            </li>
                            {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>

                <!-- Requisiti -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h4 class="card-title mb-3"><i class="fas fa-list-check text-primary"></i> Requisiti</h4>
                        <div style="white-space: pre-line;">{{ prestito.requisiti }}</div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- CTA Card -->
                <div class="card mb-4 border-danger">
                    <div class="card-body text-center">
                        <h5 class="card-title">Interessato a questo prestito?</h5>
                        <p class="card-text">Richiedi una consulenza gratuita</p>
                        <a href="{% url 'contatti' %}" class="btn btn-santander w-100 mb-2">
                            <i class="fas fa-envelope"></i> Contattaci
                        </a>
                        <a href="{% url 'calcola_rata' %}" class="btn btn-outline-danger w-100">
                            <i class="fas fa-calculator"></i> Calcola Rata
                        </a>
                    </div>
                </div>

                <!-- Informazioni Utili -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h6 class="mb-0"><i class="fas fa-info-circle"></i> Informazioni Utili</h6>
                    </div>
                    <div class="card-body">
                        <p class="small mb-2"><strong>Esempio rappresentativo:</strong></p>
                        <p class="small">Prestito di €10.000 in {{ prestito.durata_mesi_max }} mesi con TAN {{ prestito.tasso_interesse_da }}%</p>
                        <hr>
                        <p class="small mb-0"><strong>Nota:</strong> Le condizioni definitive saranno comunicate dopo la valutazione della pratica.</p>
                    </div>
                </div>

                <!-- Servizi Correlati -->
                {% if servizi_correlati %}
                <div class="card">
                    <div class="card-header bg-light">
                        <h6 class="mb-0"><i class="fas fa-lightbulb"></i> Potrebbero Interessarti</h6>
                    </div>
                    <div class="list-group list-group-flush">
                        {% for servizio in servizi_correlati %}
                        <a href="{% url 'dettaglio_servizio' servizio.pk %}" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-1">{{ servizio.nome }}</h6>
                                <small class="text-danger">{{ servizio.tasso_interesse_da }}%</small>
                            </div>
                            <p class="mb-0 small text-muted">{{ servizio.descrizione_breve|truncatewords:10 }}</p>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- CTA Bottom -->
<section class="py-5 bg-danger text-white">
    <div class="container text-center">
        <h2 class="mb-3">Pronto a Richiedere {{ prestito.nome }}?</h2>
        <p class="lead mb-4">Il nostro team è a tua disposizione per guidarti in ogni fase</p>
        <a href="{% url 'contatti' %}" class="btn btn-light btn-lg">
            <i class="fas fa-paper-plane"></i> Invia Richiesta
        </a>
    </div>
</section>
{% endblock %}